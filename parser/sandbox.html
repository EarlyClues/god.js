<html>
<head>
  <title>God Test</title>
  <script type="text/javascript" src="peg.js"></script>
  <script type="text/javascript">
  // http://tech.karbassi.com/2009/12/17/pure-javascript-flatten-array/
  Array.prototype.flatten = function flatten(){
     var flat = [];
     for (var i = 0, l = this.length; i < l; i++){
         var type = Object.prototype.toString.call(this[i]).split(' ').pop().split(']').shift().toLowerCase();
         if (type) { flat = flat.concat(/^(array|collection|arguments|object)$/.test(type) ? flatten.call(this[i]) : this[i]); }
     }
     return flat;
  };

  // http://stackoverflow.com/questions/281264/remove-empty-elements-from-an-array-in-javascript
  Array.prototype.clean = function(deleteValue) {
    for (var i = 0; i < this.length; i++) {
      if (this[i] == deleteValue) {         
        this.splice(i, 1);
        i--;
      }
    }
    return this;
  };

  var God = {
    parser: PEG.buildParser("\
    	start = s:sentence* { return s.join('') } \
      \
      sentence = scriptofjava / bullshit \
      scriptofjava = white? 'as it was said in the script of java 'i code:notamen+ amen punctuation  { return code.join(' ') + ';' } \
      bullshit = white? words:word+ punctuation { return '// ' + words.join(' ') + '\\n' } \
      \
      value = string / number \
      \
      string = string_spaces / string_spaceless \
      string_spaces = ('the'i white)? 'verse'i white s:notamen+ amen { return '\"' + s.join(' ') + '\"' } \
      string_spaceless = ('the'i white)? 'word'i white w:[^ ]+ { return '\"' + w.join('') + '\"' } \
      \
      vardef = vardef_string \
      vardef_string = 'let there be'i white s:string white 'and let it be known as'i white n:[a-zA-Z0-9]+ punctuation? { return 'var '+n.join('')+' = '+s } \
      varnull = 'let there not be'i white n:[a-zA-Z0-9]+ punctuation? { return n.join('')+' = null' } \
      varassign = 'let'i white n:[a-zA-Z0-9]+ white 'be'i white s:string { return n.join('')+' = '+s } \
      \
      conditional = conditional1 \
      conditional1 = n:[a-zA-Z0-9]+ white 'shall be'i white s:string white 'lest'i white a:alert { return 'if(!('+n.join('')+' == '+s+')) {'+a+'}' } \
      \
      alert = alert_literal / alert_var \
      alert_literal = 'they will say'i white s:string { return 'alert('+s+')' } \
      alert_var = 'they will say the'i white n:[a-zA-Z0-9]+ { return 'alert('+n.join('')+')' } \
      \
      number = num_gt100_not_mod100 / num_gt100_mod100 / num_lt20 / num_bw20_100 \
      \
      num_bw20_100 = num_bw20_100_not_mod10 / num_bw20_100_mod10 \
      num_bw20_100_not_mod10 = m:num_bw20_100_mod10 white s:num_lt20 { return m + s } \
      \
      num_gt100_mod100 = n:num_lt20 white m:magnitude { return n * m } \
      num_gt100_not_mod100 = n:num_lt20 white m:magnitude white 'and'i white s:(num_lt20 / num_bw20_100) { return n * m + s } \
      \
      num_lt20 = \
        n:( \
        thirteen_lit / \
        fourteen_lit / \
        fifteen_lit / \
        sixteen_lit / \
        seventeen_lit / \
        eighteen_lit / \
        nineteen_lit / \
        zero_lit / \
        one_lit / \
        two_lit / \
        three_lit / \
        four_lit / \
        five_lit / \
        six_lit / \
        seven_lit / \
        eight_lit / \
        nine_lit / \
        ten_lit / \
        eleven_lit / \
        twelve_lit / \
        ) boundary { return n } \
      \
      num_bw20_100_mod10 = \
        n:( twenty_lit / \
        thirty_lit / \
        forty_lit / \
        fifty_lit / \
        sixty_lit / \
        seventy_lit / \
        eighty_lit / \
        ninety_lit ) boundary { return n } \
      \
      magnitude = magnitude_lit \
      magnitude_lit = hundred_lit / thousand_lit / million_lit / billion_lit / trillion_lit / quadrillion_lit / quintillion_lit / sextillion_lit / septillion_lit / octillion_lit / nonillion_lit / decillion_lit / \
      \
      zero_lit = 'zero'i { return 0 } \
      one_lit = 'one'i { return 1 } \
      two_lit = 'two'i { return 2 } \
      three_lit = 'three'i { return 3 } \
      four_lit = 'four'i { return 4 } \
      five_lit = 'five'i { return 5 } \
      six_lit = 'six'i { return 6 } \
      seven_lit = 'seven'i { return 7 } \
      eight_lit = 'eight'i { return 8 } \
      nine_lit = 'nine'i { return 9 } \
      ten_lit = 'ten'i { return 10 } \
      eleven_lit = 'eleven'i { return 11 } \
      twelve_lit = 'twelve'i { return 12 } \
      thirteen_lit = 'thirteen'i { return 13 } \
      fourteen_lit = 'fourteen'i { return 14 } \
      fifteen_lit = 'fifteen'i { return 15 } \
      sixteen_lit = 'sixteen'i { return 16 } \
      seventeen_lit = 'seventeen'i { return 17 } \
      eighteen_lit = 'eighteen'i { return 18 } \
      nineteen_lit = 'nineteen'i { return 19 } \
      twenty_lit = 'twenty'i { return 20 } \
      thirty_lit = 'thirty'i { return 30 } \
      forty_lit = 'forty'i { return 40 } \
      fifty_lit = 'fifty'i { return 50 } \
      sixty_lit = 'sixty'i { return 60 } \
      seventy_lit = 'seventy'i { return 70 } \
      eighty_lit = 'eighty'i { return 80 } \
      ninety_lit = 'ninety'i { return 90 } \
      \
      hundred_lit = 'hundred'i { return 100 } \
      thousand_lit = 'thousand'i { return 1000 } \
      million_lit = 'million'i { return 1000000 } \
      billion_lit = 'billion'i { return 1000000000 } \
      trillion_lit = 'trillion'i { return 1000000000000 } \
      quadrillion_lit = 'quadrillion'i { return 1000000000000000 } \
      quintillion_lit = 'quintillion'i { return 1000000000000000000 } \
      sextillion_lit = 'sextillion'i { return 1000000000000000000000 } \
      septillion_lit = 'septillion'i { return 1000000000000000000000000 } \
      octillion_lit = 'octillion'i { return 1000000000000000000000000000 } \
      nonillion_lit = 'nonillion'i { return 1000000000000000000000000000000 } \
      decillion_lit = 'decillion'i { return 1000000000000000000000000000000000 } \
      \
      amen = 'amen'i { return ';' } \
      notamen = !amen w:[^ ]+ white { return w.join('') } \
      \
      punctuation = '.' / '?' / '!' / ',' \
      word = !amen white? w:[a-zA-Z]+ white? { return w.join('') } \
      \
      white = ' '+ { return undefined } \
      \
      boundary = &(white / !.) \
      ")
  }
  </script>
</head>
<body>
</body>
</html>
